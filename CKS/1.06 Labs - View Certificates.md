#### Identify the certificate file used for the kube-api server

Run the command ```cat /etc/kubernetes/manifests/kube-apiserver.yaml``` and look for the line ```--tls-cert-file```

```ruby
controlplane ~ ➜  cat /etc/kubernetes/manifests/kube-apiserver.yaml 
apiVersion: v1
kind: Pod
metadata:
  annotations:
    kubeadm.kubernetes.io/kube-apiserver.advertise-address.endpoint: 192.22.143.6:6443
  creationTimestamp: null
  labels:
    component: kube-apiserver
    tier: control-plane
  name: kube-apiserver
  namespace: kube-system
spec:
  containers:
  - command:
    - kube-apiserver
    - --advertise-address=192.22.143.6
    - --allow-privileged=true
    - --authorization-mode=Node,RBAC
    - --client-ca-file=/etc/kubernetes/pki/ca.crt
    - --enable-admission-plugins=NodeRestriction
    - --enable-bootstrap-token-auth=true
    - --etcd-cafile=/etc/kubernetes/pki/etcd/ca.crt
    - --etcd-certfile=/etc/kubernetes/pki/apiserver-etcd-client.crt
    - --etcd-keyfile=/etc/kubernetes/pki/apiserver-etcd-client.key
    - --etcd-servers=https://127.0.0.1:2379
    - --kubelet-client-certificate=/etc/kubernetes/pki/apiserver-kubelet-client.crt
    - --kubelet-client-key=/etc/kubernetes/pki/apiserver-kubelet-client.key
    - --kubelet-preferred-address-types=InternalIP,ExternalIP,Hostname
    - --proxy-client-cert-file=/etc/kubernetes/pki/front-proxy-client.crt
    - --proxy-client-key-file=/etc/kubernetes/pki/front-proxy-client.key
    - --requestheader-allowed-names=front-proxy-client
    - --requestheader-client-ca-file=/etc/kubernetes/pki/front-proxy-ca.crt
    - --requestheader-extra-headers-prefix=X-Remote-Extra-
    - --requestheader-group-headers=X-Remote-Group
    - --requestheader-username-headers=X-Remote-User
    - --secure-port=6443
    - --service-account-issuer=https://kubernetes.default.svc.cluster.local
    - --service-account-key-file=/etc/kubernetes/pki/sa.pub
    - --service-account-signing-key-file=/etc/kubernetes/pki/sa.key
    - --service-cluster-ip-range=10.96.0.0/12
    - --tls-cert-file=/etc/kubernetes/pki/apiserver.crt
    - --tls-private-key-file=/etc/kubernetes/pki/apiserver.key
    image: registry.k8s.io/kube-apiserver:v1.31.0
    imagePullPolicy: IfNotPresent
    livenessProbe:
      failureThreshold: 8
      httpGet:
        host: 192.22.143.6
        path: /livez
        port: 6443
        scheme: HTTPS
      initialDelaySeconds: 10
```

#### Identify the Certificate file used to authenticate kube-apiserver as a client to ETCD Server.

Run the command cat /etc/kubernetes/manifests/kube-apiserver.yaml and look for value of etcd-certfile flag.

#### Identify the key used to authenticate kubeapi-server to the kubelet server.

Look for kubelet-client-key option in the file /etc/kubernetes/manifests/kube-apiserver.yaml.

#### Identify the ETCD Server Certificate used to host ETCD server.

Look for cert-file option in the file /etc/kubernetes/manifests/etcd.yaml.

```ruby
controlplane ~ ➜  cat /etc/kubernetes/manifests/etcd.yaml 
apiVersion: v1
kind: Pod
metadata:
  annotations:
    kubeadm.kubernetes.io/etcd.advertise-client-urls: https://192.22.143.6:2379
  creationTimestamp: null
  labels:
    component: etcd
    tier: control-plane
  name: etcd
  namespace: kube-system
spec:
  containers:
  - command:
    - etcd
    - --advertise-client-urls=https://192.22.143.6:2379
    - --cert-file=/etc/kubernetes/pki/etcd/server.crt
    - --client-cert-auth=true
    - --data-dir=/var/lib/etcd
    - --experimental-initial-corrupt-check=true
    - --experimental-watch-progress-notify-interval=5s
    - --initial-advertise-peer-urls=https://192.22.143.6:2380
    - --initial-cluster=controlplane=https://192.22.143.6:2380
    - --key-file=/etc/kubernetes/pki/etcd/server.key
    - --listen-client-urls=https://127.0.0.1:2379,https://192.22.143.6:2379
    - --listen-metrics-urls=http://127.0.0.1:2381
    - --listen-peer-urls=https://192.22.143.6:2380
    - --name=controlplane
    - --peer-cert-file=/etc/kubernetes/pki/etcd/peer.crt
    - --peer-client-cert-auth=true
    - --peer-key-file=/etc/kubernetes/pki/etcd/peer.key
    - --peer-trusted-ca-file=/etc/kubernetes/pki/etcd/ca.crt
    - --snapshot-count=10000
    - --trusted-ca-file=/etc/kubernetes/pki/etcd/ca.crt
    image: registry.k8s.io/etcd:3.5.15-0
    imagePullPolicy: IfNotPresent
    livenessProbe:
      failureThreshold: 8
      httpGet:
        host: 127.0.0.1
        path: /livez
        port: 2381
        scheme: HTTP
      initialDelaySeconds: 10
      periodSeconds: 10
      timeoutSeconds: 15
    name: etcd
    readinessProbe:
      failureThreshold: 3
      httpGet:
        host: 127.0.0.1
        path: /readyz
        port: 2381
        scheme: HTTP
      periodSeconds: 1
      timeoutSeconds: 15
    resources:
      requests:
        cpu: 100m
        memory: 100Mi
    startupProbe:
      failureThreshold: 24
      httpGet:
        host: 127.0.0.1
        path: /readyz
        port: 2381
        scheme: HTTP
      initialDelaySeconds: 10
      periodSeconds: 10
      timeoutSeconds: 15
    volumeMounts:
    - mountPath: /var/lib/etcd
      name: etcd-data
    - mountPath: /etc/kubernetes/pki/etcd
      name: etcd-certs
  hostNetwork: true
  priority: 2000001000
  priorityClassName: system-node-critical
  securityContext:
    seccompProfile:
      type: RuntimeDefault
  volumes:
  - hostPath:
      path: /etc/kubernetes/pki/etcd
      type: DirectoryOrCreate
    name: etcd-certs
  - hostPath:
      path: /var/lib/etcd
      type: DirectoryOrCreate
    name: etcd-data
status: {}

controlplane ~ ➜  
```

### Identify the ETCD Server CA Root Certificate used to serve ETCD Server.

ETCD can have its own CA. So this may be a different CA certificate than the one used by kube-api server.

Look for CA Certificate ```(trusted-ca-file)``` in file ```/etc/kubernetes/manifests/etcd.yaml```.

### What is the Common Name (CN) configured on the Kube API Server Certificate?

OpenSSL Syntax: ```openssl x509 -in file-path.crt -text -noout```


Run the command ```openssl x509 -in /etc/kubernetes/pki/apiserver.crt -text``` and look for Subject CN.


```ruby

controlplane ~ ➜  openssl x509 -in /etc/kubernetes/pki/apiserver.crt -text
Certificate:
    Data:
        Version: 3 (0x2)
        Serial Number: 5277496037475565857 (0x493d6eaf49434121)
        Signature Algorithm: sha256WithRSAEncryption
        Issuer: CN = kubernetes
        Validity
            Not Before: Oct 18 12:32:31 2024 GMT
            Not After : Oct 18 12:37:31 2025 GMT
        Subject: CN = kube-apiserver
        Subject Public Key Info:
            Public Key Algorithm: rsaEncryption
                Public-Key: (2048 bit)
                Modulus:
                    00:af:af:e2:46:37:2b:02:ef:02:cc:a1:94:38:a6:
                    16:05:29:12:3b:a8:8c:b0:21:a5:a5:d0:a2:d2:fb:
                    5f:ed:3e:b6:79:3a:aa:9a:b2:50:58:41:7c:9b:ad:
                    30:34:2a:4b:5b:c3:82:80:10:3a:9b:8c:03:05:b4:
                    7e:e3:ac:0c:4e:cf:96:41:2b:a5:8b:7b:ad:c6:5f:
                    6c:61:0a:9f:50:eb:23:f6:26:5e:85:64:c4:d7:5a:
                    54:09:66:c5:f9:55:5d:49:5a:6c:9a:07:8c:d1:d5:
                    79:da:b3:da:7e:22:11:eb:23:ab:97:d8:5d:79:75:
                    3a:53:09:59:56:6c:2a:46:95:d1:8c:22:e6:92:b2:
                    d5:80:79:68:04:13:15:17:95:bf:d4:a1:7b:ce:6f:
                    91:09:23:c7:98:34:c6:58:42:ff:a2:9e:81:68:38:
                    3f:09:37:35:2b:6d:ba:9e:3f:69:0f:10:da:0e:2a:
                    22:58:7c:cb:5f:25:c3:59:ba:34:a5:87:23:a7:11:
                    de:51:dd:b8:ed:95:48:06:32:11:38:da:69:d9:3a:
                    72:d5:24:df:9e:21:54:0f:13:07:b5:bc:16:25:9e:
                    ca:b1:f0:4e:74:50:18:f7:4b:aa:f7:34:89:32:9d:
                    bc:53:a8:e8:ca:14:0e:6c:1f:fc:a6:b5:ff:cc:06:
                    7e:19
                Exponent: 65537 (0x10001)
        X509v3 extensions:
            X509v3 Key Usage: critical
                Digital Signature, Key Encipherment
            X509v3 Extended Key Usage: 
                TLS Web Server Authentication
            X509v3 Basic Constraints: critical
                CA:FALSE
            X509v3 Authority Key Identifier: 
                5D:B9:14:05:F3:93:AD:AE:0E:45:F8:60:E0:FD:8E:8D:4E:09:D6:8F
            X509v3 Subject Alternative Name: 
                DNS:controlplane, DNS:kubernetes, DNS:kubernetes.default, DNS:kubernetes.default.svc, DNS:kubernetes.default.svc.cluster.local, IP Address:10.96.0.1, IP Address:192.22.143.6
    Signature Algorithm: sha256WithRSAEncryption
    Signature Value:
        b4:dd:20:1f:1e:c5:6b:c3:68:b1:3e:8b:6f:2e:b2:2e:06:89:
        32:70:59:f7:7a:a6:8b:63:7f:a9:2f:92:17:44:fb:7c:db:14:
        ec:62:9c:75:3a:9f:b8:03:7a:f3:38:a3:97:60:21:7b:30:22:
        ac:c6:11:c8:1a:e2:ae:f8:0e:ec:62:39:65:04:a1:0d:eb:70:
        af:2e:ec:43:d1:6e:46:6e:c2:64:fd:c8:11:94:57:51:b7:a5:
        cd:47:3e:3b:a6:7c:be:cc:a9:f3:ad:31:29:58:37:64:b2:b4:
        45:20:58:7b:1a:e7:90:7b:50:fc:4e:b2:68:97:05:50:3e:ae:
        0e:ee:38:5d:c2:ea:92:e7:06:1e:91:c1:17:7a:bb:68:2e:27:
        c9:32:88:cc:6a:aa:2f:ef:81:8d:4a:3b:b8:c8:ac:5f:6d:b0:
        20:a4:2c:94:f1:8d:36:f4:a0:f3:5c:d9:19:32:ed:d6:07:bf:
        d9:5c:e4:36:77:e6:c1:5a:72:8f:40:7c:f6:54:77:9d:2e:35:
        ff:4c:a5:8f:eb:15:4d:06:be:b6:0c:4d:84:fb:eb:08:7a:2e:
        c5:c0:05:e8:09:35:ab:81:30:d4:aa:68:7e:b3:14:f1:49:76:
        ee:3c:ae:c1:b0:f9:10:e4:66:40:a2:bf:7b:75:91:fd:b4:69:
        6f:37:2c:f6
-----BEGIN CERTIFICATE-----
MIIDjDCCAnSgAwIBAgIIST1ur0lDQSEwDQYJKoZIhvcNAQELBQAwFTETMBEGA1UE
AxMKa3ViZXJuZXRlczAeFw0yNDEwMTgxMjMyMzFaFw0yNTEwMTgxMjM3MzFaMBkx
FzAVBgNVBAMTDmt1YmUtYXBpc2VydmVyMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8A
MIIBCgKCAQEAr6/iRjcrAu8CzKGUOKYWBSkSO6iMsCGlpdCi0vtf7T62eTqqmrJQ
WEF8m60wNCpLW8OCgBA6m4wDBbR+46wMTs+WQSuli3utxl9sYQqfUOsj9iZehWTE
11pUCWbF+VVdSVpsmgeM0dV52rPafiIR6yOrl9hdeXU6UwlZVmwqRpXRjCLmkrLV
gHloBBMVF5W/1KF7zm+RCSPHmDTGWEL/op6BaDg/CTc1K226nj9pDxDaDioiWHzL
XyXDWbo0pYcjpxHeUd247ZVIBjIRONpp2Tpy1STfniFUDxMHtbwWJZ7KsfBOdFAY
90uq9zSJMp28U6joyhQObB/8prX/zAZ+GQIDAQABo4HbMIHYMA4GA1UdDwEB/wQE
AwIFoDATBgNVHSUEDDAKBggrBgEFBQcDATAMBgNVHRMBAf8EAjAAMB8GA1UdIwQY
MBaAFF25FAXzk62uDkX4YOD9jo1OCdaPMIGBBgNVHREEejB4ggxjb250cm9scGxh
bmWCCmt1YmVybmV0ZXOCEmt1YmVybmV0ZXMuZGVmYXVsdIIWa3ViZXJuZXRlcy5k
ZWZhdWx0LnN2Y4Ika3ViZXJuZXRlcy5kZWZhdWx0LnN2Yy5jbHVzdGVyLmxvY2Fs
hwQKYAABhwTAFo8GMA0GCSqGSIb3DQEBCwUAA4IBAQC03SAfHsVrw2ixPotvLrIu
BokycFn3eqaLY3+pL5IXRPt82xTsYpx1Op+4A3rzOKOXYCF7MCKsxhHIGuKu+A7s
YjllBKEN63CvLuxD0W5GbsJk/cgRlFdRt6XNRz47pny+zKnzrTEpWDdksrRFIFh7
GueQe1D8TrJolwVQPq4O7jhdwuqS5wYekcEXertoLifJMojMaqov74GNSju4yKxf
bbAgpCyU8Y029KDzXNkZMu3WB7/ZXOQ2d+bBWnKPQHz2VHedLjX/TKWP6xVNBr62
DE2E++sIei7FwAXoCTWrgTDUqmh+sxTxSXbuPK7BsPkQ5GZAor97dZH9tGlvNyz2
-----END CERTIFICATE-----

controlplane ~ ➜  
```


### What is the name of the CA who issued the Kube API Server Certificate?


Run the command openssl x509 -in /etc/kubernetes/pki/apiserver.crt -text and look for issuer.

```ruby

controlplane ~ ➜  openssl x509 -in /etc/kubernetes/pki/apiserver.crt -text
Certificate:
    Data:
        Version: 3 (0x2)
        Serial Number: 5277496037475565857 (0x493d6eaf49434121)
        Signature Algorithm: sha256WithRSAEncryption
        Issuer: CN = kubernetes
        Validity
            Not Before: Oct 18 12:32:31 2024 GMT
            Not After : Oct 18 12:37:31 2025 GMT
        Subject: CN = kube-apiserver
        Subject Public Key Info:
            Public Key Algorithm: rsaEncryption
                Public-Key: (2048 bit)
                Modulus:
                    00:af:af:e2:46:37:2b:02:ef:02:cc:a1:94:38:a6:
                    16:05:29:12:3b:a8:8c:b0:21:a5:a5:d0:a2:d2:fb:
                    5f:ed:3e:b6:79:3a:aa:9a:b2:50:58:41:7c:9b:ad:
                    30:34:2a:4b:5b:c3:82:80:10:3a:9b:8c:03:05:b4:
                    7e:e3:ac:0c:4e:cf:96:41:2b:a5:8b:7b:ad:c6:5f:
                    6c:61:0a:9f:50:eb:23:f6:26:5e:85:64:c4:d7:5a:
                    54:09:66:c5:f9:55:5d:49:5a:6c:9a:07:8c:d1:d5:
                    79:da:b3:da:7e:22:11:eb:23:ab:97:d8:5d:79:75:
                    3a:53:09:59:56:6c:2a:46:95:d1:8c:22:e6:92:b2:
                    d5:80:79:68:04:13:15:17:95:bf:d4:a1:7b:ce:6f:
                    91:09:23:c7:98:34:c6:58:42:ff:a2:9e:81:68:38:
                    3f:09:37:35:2b:6d:ba:9e:3f:69:0f:10:da:0e:2a:
                    22:58:7c:cb:5f:25:c3:59:ba:34:a5:87:23:a7:11:
                    de:51:dd:b8:ed:95:48:06:32:11:38:da:69:d9:3a:
                    72:d5:24:df:9e:21:54:0f:13:07:b5:bc:16:25:9e:
                    ca:b1:f0:4e:74:50:18:f7:4b:aa:f7:34:89:32:9d:
                    bc:53:a8:e8:ca:14:0e:6c:1f:fc:a6:b5:ff:cc:06:
                    7e:19
                Exponent: 65537 (0x10001)
        X509v3 extensions:
            X509v3 Key Usage: critical
                Digital Signature, Key Encipherment
            X509v3 Extended Key Usage: 
                TLS Web Server Authentication
            X509v3 Basic Constraints: critical
                CA:FALSE
            X509v3 Authority Key Identifier: 
                5D:B9:14:05:F3:93:AD:AE:0E:45:F8:60:E0:FD:8E:8D:4E:09:D6:8F
            X509v3 Subject Alternative Name: 
                DNS:controlplane, DNS:kubernetes, DNS:kubernetes.default, DNS:kubernetes.default.svc, DNS:kubernetes.default.svc.cluster.local, IP Address:10.96.0.1, IP Address:192.22.143.6
    Signature Algorithm: sha256WithRSAEncryption
    Signature Value:
        b4:dd:20:1f:1e:c5:6b:c3:68:b1:3e:8b:6f:2e:b2:2e:06:89:
        32:70:59:f7:7a:a6:8b:63:7f:a9:2f:92:17:44:fb:7c:db:14:
        ec:62:9c:75:3a:9f:b8:03:7a:f3:38:a3:97:60:21:7b:30:22:
        ac:c6:11:c8:1a:e2:ae:f8:0e:ec:62:39:65:04:a1:0d:eb:70:
        af:2e:ec:43:d1:6e:46:6e:c2:64:fd:c8:11:94:57:51:b7:a5:
        cd:47:3e:3b:a6:7c:be:cc:a9:f3:ad:31:29:58:37:64:b2:b4:
        45:20:58:7b:1a:e7:90:7b:50:fc:4e:b2:68:97:05:50:3e:ae:
        0e:ee:38:5d:c2:ea:92:e7:06:1e:91:c1:17:7a:bb:68:2e:27:
        c9:32:88:cc:6a:aa:2f:ef:81:8d:4a:3b:b8:c8:ac:5f:6d:b0:
        20:a4:2c:94:f1:8d:36:f4:a0:f3:5c:d9:19:32:ed:d6:07:bf:
        d9:5c:e4:36:77:e6:c1:5a:72:8f:40:7c:f6:54:77:9d:2e:35:
        ff:4c:a5:8f:eb:15:4d:06:be:b6:0c:4d:84:fb:eb:08:7a:2e:
        c5:c0:05:e8:09:35:ab:81:30:d4:aa:68:7e:b3:14:f1:49:76:
        ee:3c:ae:c1:b0:f9:10:e4:66:40:a2:bf:7b:75:91:fd:b4:69:
        6f:37:2c:f6
-----BEGIN CERTIFICATE-----
MIIDjDCCAnSgAwIBAgIIST1ur0lDQSEwDQYJKoZIhvcNAQELBQAwFTETMBEGA1UE
AxMKa3ViZXJuZXRlczAeFw0yNDEwMTgxMjMyMzFaFw0yNTEwMTgxMjM3MzFaMBkx
FzAVBgNVBAMTDmt1YmUtYXBpc2VydmVyMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8A
MIIBCgKCAQEAr6/iRjcrAu8CzKGUOKYWBSkSO6iMsCGlpdCi0vtf7T62eTqqmrJQ
WEF8m60wNCpLW8OCgBA6m4wDBbR+46wMTs+WQSuli3utxl9sYQqfUOsj9iZehWTE
11pUCWbF+VVdSVpsmgeM0dV52rPafiIR6yOrl9hdeXU6UwlZVmwqRpXRjCLmkrLV
gHloBBMVF5W/1KF7zm+RCSPHmDTGWEL/op6BaDg/CTc1K226nj9pDxDaDioiWHzL
XyXDWbo0pYcjpxHeUd247ZVIBjIRONpp2Tpy1STfniFUDxMHtbwWJZ7KsfBOdFAY
90uq9zSJMp28U6joyhQObB/8prX/zAZ+GQIDAQABo4HbMIHYMA4GA1UdDwEB/wQE
AwIFoDATBgNVHSUEDDAKBggrBgEFBQcDATAMBgNVHRMBAf8EAjAAMB8GA1UdIwQY
MBaAFF25FAXzk62uDkX4YOD9jo1OCdaPMIGBBgNVHREEejB4ggxjb250cm9scGxh
bmWCCmt1YmVybmV0ZXOCEmt1YmVybmV0ZXMuZGVmYXVsdIIWa3ViZXJuZXRlcy5k
ZWZhdWx0LnN2Y4Ika3ViZXJuZXRlcy5kZWZhdWx0LnN2Yy5jbHVzdGVyLmxvY2Fs
hwQKYAABhwTAFo8GMA0GCSqGSIb3DQEBCwUAA4IBAQC03SAfHsVrw2ixPotvLrIu
BokycFn3eqaLY3+pL5IXRPt82xTsYpx1Op+4A3rzOKOXYCF7MCKsxhHIGuKu+A7s
YjllBKEN63CvLuxD0W5GbsJk/cgRlFdRt6XNRz47pny+zKnzrTEpWDdksrRFIFh7
GueQe1D8TrJolwVQPq4O7jhdwuqS5wYekcEXertoLifJMojMaqov74GNSju4yKxf
bbAgpCyU8Y029KDzXNkZMu3WB7/ZXOQ2d+bBWnKPQHz2VHedLjX/TKWP6xVNBr62
DE2E++sIei7FwAXoCTWrgTDUqmh+sxTxSXbuPK7BsPkQ5GZAor97dZH9tGlvNyz2
-----END CERTIFICATE-----

controlplane ~ ➜  
```

### alternate names is configured on the Kube API Server Certificate?


```ruby

controlplane ~ ➜  openssl x509 -in /etc/kubernetes/pki/apiserver.crt -text
Certificate:
    Data:
        Version: 3 (0x2)
        Serial Number: 5277496037475565857 (0x493d6eaf49434121)
        Signature Algorithm: sha256WithRSAEncryption
        Issuer: CN = kubernetes
        Validity
            Not Before: Oct 18 12:32:31 2024 GMT
            Not After : Oct 18 12:37:31 2025 GMT
        Subject: CN = kube-apiserver
        Subject Public Key Info:
            Public Key Algorithm: rsaEncryption
                Public-Key: (2048 bit)
                Modulus:
                    00:af:af:e2:46:37:2b:02:ef:02:cc:a1:94:38:a6:
                    16:05:29:12:3b:a8:8c:b0:21:a5:a5:d0:a2:d2:fb:
                    5f:ed:3e:b6:79:3a:aa:9a:b2:50:58:41:7c:9b:ad:
                    30:34:2a:4b:5b:c3:82:80:10:3a:9b:8c:03:05:b4:
                    7e:e3:ac:0c:4e:cf:96:41:2b:a5:8b:7b:ad:c6:5f:
                    6c:61:0a:9f:50:eb:23:f6:26:5e:85:64:c4:d7:5a:
                    54:09:66:c5:f9:55:5d:49:5a:6c:9a:07:8c:d1:d5:
                    79:da:b3:da:7e:22:11:eb:23:ab:97:d8:5d:79:75:
                    3a:53:09:59:56:6c:2a:46:95:d1:8c:22:e6:92:b2:
                    d5:80:79:68:04:13:15:17:95:bf:d4:a1:7b:ce:6f:
                    91:09:23:c7:98:34:c6:58:42:ff:a2:9e:81:68:38:
                    3f:09:37:35:2b:6d:ba:9e:3f:69:0f:10:da:0e:2a:
                    22:58:7c:cb:5f:25:c3:59:ba:34:a5:87:23:a7:11:
                    de:51:dd:b8:ed:95:48:06:32:11:38:da:69:d9:3a:
                    72:d5:24:df:9e:21:54:0f:13:07:b5:bc:16:25:9e:
                    ca:b1:f0:4e:74:50:18:f7:4b:aa:f7:34:89:32:9d:
                    bc:53:a8:e8:ca:14:0e:6c:1f:fc:a6:b5:ff:cc:06:
                    7e:19
                Exponent: 65537 (0x10001)
        X509v3 extensions:
            X509v3 Key Usage: critical
                Digital Signature, Key Encipherment
            X509v3 Extended Key Usage: 
                TLS Web Server Authentication
            X509v3 Basic Constraints: critical
                CA:FALSE
            X509v3 Authority Key Identifier: 
                5D:B9:14:05:F3:93:AD:AE:0E:45:F8:60:E0:FD:8E:8D:4E:09:D6:8F
            X509v3 Subject Alternative Name: 
                DNS:controlplane, DNS:kubernetes, DNS:kubernetes.default, DNS:kubernetes.default.svc, DNS:kubernetes.default.svc.cluster.local, IP Address:10.96.0.1, IP Address:192.22.143.6
    Signature Algorithm: sha256WithRSAEncryption
    Signature Value:
        b4:dd:20:1f:1e:c5:6b:c3:68:b1:3e:8b:6f:2e:b2:2e:06:89:
        32:70:59:f7:7a:a6:8b:63:7f:a9:2f:92:17:44:fb:7c:db:14:
        ec:62:9c:75:3a:9f:b8:03:7a:f3:38:a3:97:60:21:7b:30:22:
        ac:c6:11:c8:1a:e2:ae:f8:0e:ec:62:39:65:04:a1:0d:eb:70:
        af:2e:ec:43:d1:6e:46:6e:c2:64:fd:c8:11:94:57:51:b7:a5:
        cd:47:3e:3b:a6:7c:be:cc:a9:f3:ad:31:29:58:37:64:b2:b4:
        45:20:58:7b:1a:e7:90:7b:50:fc:4e:b2:68:97:05:50:3e:ae:
        0e:ee:38:5d:c2:ea:92:e7:06:1e:91:c1:17:7a:bb:68:2e:27:
        c9:32:88:cc:6a:aa:2f:ef:81:8d:4a:3b:b8:c8:ac:5f:6d:b0:
        20:a4:2c:94:f1:8d:36:f4:a0:f3:5c:d9:19:32:ed:d6:07:bf:
        d9:5c:e4:36:77:e6:c1:5a:72:8f:40:7c:f6:54:77:9d:2e:35:
        ff:4c:a5:8f:eb:15:4d:06:be:b6:0c:4d:84:fb:eb:08:7a:2e:
        c5:c0:05:e8:09:35:ab:81:30:d4:aa:68:7e:b3:14:f1:49:76:
        ee:3c:ae:c1:b0:f9:10:e4:66:40:a2:bf:7b:75:91:fd:b4:69:
        6f:37:2c:f6
-----BEGIN CERTIFICATE-----
MIIDjDCCAnSgAwIBAgIIST1ur0lDQSEwDQYJKoZIhvcNAQELBQAwFTETMBEGA1UE
AxMKa3ViZXJuZXRlczAeFw0yNDEwMTgxMjMyMzFaFw0yNTEwMTgxMjM3MzFaMBkx
FzAVBgNVBAMTDmt1YmUtYXBpc2VydmVyMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8A
MIIBCgKCAQEAr6/iRjcrAu8CzKGUOKYWBSkSO6iMsCGlpdCi0vtf7T62eTqqmrJQ
WEF8m60wNCpLW8OCgBA6m4wDBbR+46wMTs+WQSuli3utxl9sYQqfUOsj9iZehWTE
11pUCWbF+VVdSVpsmgeM0dV52rPafiIR6yOrl9hdeXU6UwlZVmwqRpXRjCLmkrLV
gHloBBMVF5W/1KF7zm+RCSPHmDTGWEL/op6BaDg/CTc1K226nj9pDxDaDioiWHzL
XyXDWbo0pYcjpxHeUd247ZVIBjIRONpp2Tpy1STfniFUDxMHtbwWJZ7KsfBOdFAY
90uq9zSJMp28U6joyhQObB/8prX/zAZ+GQIDAQABo4HbMIHYMA4GA1UdDwEB/wQE
AwIFoDATBgNVHSUEDDAKBggrBgEFBQcDATAMBgNVHRMBAf8EAjAAMB8GA1UdIwQY
MBaAFF25FAXzk62uDkX4YOD9jo1OCdaPMIGBBgNVHREEejB4ggxjb250cm9scGxh
bmWCCmt1YmVybmV0ZXOCEmt1YmVybmV0ZXMuZGVmYXVsdIIWa3ViZXJuZXRlcy5k
ZWZhdWx0LnN2Y4Ika3ViZXJuZXRlcy5kZWZhdWx0LnN2Yy5jbHVzdGVyLmxvY2Fs
hwQKYAABhwTAFo8GMA0GCSqGSIb3DQEBCwUAA4IBAQC03SAfHsVrw2ixPotvLrIu
BokycFn3eqaLY3+pL5IXRPt82xTsYpx1Op+4A3rzOKOXYCF7MCKsxhHIGuKu+A7s
YjllBKEN63CvLuxD0W5GbsJk/cgRlFdRt6XNRz47pny+zKnzrTEpWDdksrRFIFh7
GueQe1D8TrJolwVQPq4O7jhdwuqS5wYekcEXertoLifJMojMaqov74GNSju4yKxf
bbAgpCyU8Y029KDzXNkZMu3WB7/ZXOQ2d+bBWnKPQHz2VHedLjX/TKWP6xVNBr62
DE2E++sIei7FwAXoCTWrgTDUqmh+sxTxSXbuPK7BsPkQ5GZAor97dZH9tGlvNyz2
-----END CERTIFICATE-----

controlplane ~ ➜  
```
#### What is the Common Name (CN) configured on the ETCD Server certificate?

Run the command openssl x509 -in /etc/kubernetes/pki/etcd/server.crt -text and look for Subject CN.

```ruby
controlplane ~ ➜  openssl x509 -in /etc/kubernetes/pki/etcd/server.crt -text
Certificate:
    Data:
        Version: 3 (0x2)
        Serial Number: 7270824084669757041 (0x64e727fb87187671)
        Signature Algorithm: sha256WithRSAEncryption
        Issuer: CN = etcd-ca
        Validity
            Not Before: Oct 18 12:32:31 2024 GMT
            Not After : Oct 18 12:37:31 2025 GMT
        Subject: CN = controlplane
        Subject Public Key Info:
            Public Key Algorithm: rsaEncryption
                Public-Key: (2048 bit)
                Modulus:
                    00:a1:d6:29:ad:cf:ca:fb:fd:1b:f9:c2:db:be:27:
                    e7:c1:ec:d4:98:57:cc:d0:42:c5:b5:a0:12:08:95:
                    bf:64:03:84:7e:72:08:43:b5:f3:8a:b0:11:74:08:
                    21:9d:f6:6c:2d:ad:4e:f4:13:7f:c4:73:2c:e8:4e:
                    77:b7:7f:77:e0:c4:90:29:f2:d9:b8:a6:5b:c3:38:
                    de:9e:7f:8e:79:b0:83:d9:d8:48:97:76:26:14:ae:
                    12:b2:68:b4:21:80:1f:8f:1f:a5:30:b9:20:f7:58:
                    9a:f1:ae:78:3a:a7:35:9b:c3:ff:59:e6:2d:4b:9d:
                    5e:9d:b3:89:4f:90:cd:40:8f:a8:b1:c5:6d:4f:a5:
                    be:25:97:0f:b0:1f:89:fb:51:c0:9e:dc:6f:a4:ee:
                    f3:66:8c:61:a9:e3:23:de:f6:72:b2:ca:fb:24:df:
                    50:e8:1a:c6:27:5f:57:03:66:27:b8:fe:4d:ee:15:
                    bc:44:59:2f:6f:8f:5a:e2:6a:3f:c1:1e:8e:a2:cc:
                    75:b8:bb:b8:2e:dc:6c:f9:07:5e:09:49:74:8b:2f:
                    0e:d8:18:c8:0f:36:ee:5a:5f:61:d7:f3:ca:0a:3f:
                    16:c5:3b:4a:73:db:25:f0:57:b5:dc:3c:0e:2e:04:
                    9b:f6:39:d6:64:fc:e5:fa:28:68:76:75:c1:8e:00:
                    e3:55
                Exponent: 65537 (0x10001)
        X509v3 extensions:
            X509v3 Key Usage: critical
                Digital Signature, Key Encipherment
            X509v3 Extended Key Usage: 
                TLS Web Server Authentication, TLS Web Client Authentication
            X509v3 Basic Constraints: critical
                CA:FALSE
            X509v3 Authority Key Identifier: 
                F1:99:4C:C8:87:63:87:B9:04:47:F1:61:A3:D0:82:C0:59:62:75:03
            X509v3 Subject Alternative Name: 
                DNS:controlplane, DNS:localhost, IP Address:192.22.143.6, IP Address:127.0.0.1, IP Address:0:0:0:0:0:0:0:1
    Signature Algorithm: sha256WithRSAEncryption
    Signature Value:
        d9:2f:dc:4e:23:53:67:9d:a2:ce:a4:66:73:5f:0c:ca:e9:b9:
        f1:9d:57:06:72:5c:59:51:07:25:8e:d2:04:22:29:a3:69:9e:
        4b:31:d4:78:36:7e:ff:53:53:06:ae:2d:03:9e:e3:72:a0:c6:
        4d:ec:99:a4:6b:1c:b9:1c:7f:e5:7a:ed:3e:3c:70:67:cd:a6:
        35:cd:c5:4e:8a:73:ee:98:a5:78:75:85:ae:3c:66:1d:c6:71:
        70:d5:11:b7:d3:fe:d1:47:68:5e:04:ea:f6:d0:0d:fe:d5:4a:
        8f:9d:4e:d3:f0:68:c6:61:c8:ae:12:26:9c:35:ad:c9:0b:92:
        ff:b5:e4:33:12:d9:2b:93:44:60:f7:bc:0c:b6:df:c9:7c:ec:
        43:59:b0:18:34:75:0a:6a:c6:5f:24:28:e3:f1:3a:e6:3a:03:
        4e:6d:1d:d0:85:06:c4:50:f8:77:2e:2a:1d:f4:9d:1f:08:3c:
        2f:e4:a7:fe:6c:9b:a4:ce:03:1f:3a:57:a3:3e:68:56:bf:2d:
        1f:53:01:36:37:b1:ab:78:f9:72:57:8c:22:f2:95:65:5f:49:
        e5:5a:68:80:73:3e:e3:08:4c:cd:90:8e:78:62:6b:5b:fe:e6:
        11:b0:d7:54:56:0c:43:26:66:5a:60:95:8e:8f:a3:aa:49:83:
        28:17:99:c1
-----BEGIN CERTIFICATE-----
MIIDTzCCAjegAwIBAgIIZOcn+4cYdnEwDQYJKoZIhvcNAQELBQAwEjEQMA4GA1UE
AxMHZXRjZC1jYTAeFw0yNDEwMTgxMjMyMzFaFw0yNTEwMTgxMjM3MzFaMBcxFTAT
BgNVBAMTDGNvbnRyb2xwbGFuZTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC
ggEBAKHWKa3Pyvv9G/nC274n58Hs1JhXzNBCxbWgEgiVv2QDhH5yCEO184qwEXQI
IZ32bC2tTvQTf8RzLOhOd7d/d+DEkCny2bimW8M43p5/jnmwg9nYSJd2JhSuErJo
tCGAH48fpTC5IPdYmvGueDqnNZvD/1nmLUudXp2ziU+QzUCPqLHFbU+lviWXD7Af
iftRwJ7cb6Tu82aMYanjI972crLK+yTfUOgaxidfVwNmJ7j+Te4VvERZL2+PWuJq
P8EejqLMdbi7uC7cbPkHXglJdIsvDtgYyA827lpfYdfzygo/FsU7SnPbJfBXtdw8
Di4Em/Y51mT85fooaHZ1wY4A41UCAwEAAaOBozCBoDAOBgNVHQ8BAf8EBAMCBaAw
HQYDVR0lBBYwFAYIKwYBBQUHAwEGCCsGAQUFBwMCMAwGA1UdEwEB/wQCMAAwHwYD
VR0jBBgwFoAU8ZlMyIdjh7kER/Fho9CCwFlidQMwQAYDVR0RBDkwN4IMY29udHJv
bHBsYW5lgglsb2NhbGhvc3SHBMAWjwaHBH8AAAGHEAAAAAAAAAAAAAAAAAAAAAEw
DQYJKoZIhvcNAQELBQADggEBANkv3E4jU2edos6kZnNfDMrpufGdVwZyXFlRByWO
0gQiKaNpnksx1Hg2fv9TUwauLQOe43Kgxk3smaRrHLkcf+V67T48cGfNpjXNxU6K
c+6YpXh1ha48Zh3GcXDVEbfT/tFHaF4E6vbQDf7VSo+dTtPwaMZhyK4SJpw1rckL
kv+15DMS2SuTRGD3vAy238l87ENZsBg0dQpqxl8kKOPxOuY6A05tHdCFBsRQ+Hcu
Kh30nR8IPC/kp/5sm6TOAx86V6M+aFa/LR9TATY3sat4+XJXjCLylWVfSeVaaIBz
PuMITM2Qjnhia1v+5hGw11RWDEMmZlpglY6Po6pJgygXmcE=
-----END CERTIFICATE-----

controlplane ~ ➜


```


### How long, from the issued date, is the Kube-API Server Certificate valid for?

File: /etc/kubernetes/pki/apiserver.crt

Run the command openssl x509 -in /etc/kubernetes/pki/apiserver.crt -text and check on the Expiry date


```ruby
controlplane ~ ➜  openssl x509 -in /etc/kubernetes/pki/apiserver.crt -text
Certificate:
    Data:
        Version: 3 (0x2)
        Serial Number: 5277496037475565857 (0x493d6eaf49434121)
        Signature Algorithm: sha256WithRSAEncryption
        Issuer: CN = kubernetes
        Validity
            Not Before: Oct 18 12:32:31 2024 GMT
            Not After : Oct 18 12:37:31 2025 GMT
        Subject: CN = kube-apiserver
        Subject Public Key Info:
            Public Key Algorithm: rsaEncryption
                Public-Key: (2048 bit)
                Modulus:
                    00:af:af:e2:46:37:2b:02:ef:02:cc:a1:94:38:a6:
                    16:05:29:12:3b:a8:8c:b0:21:a5:a5:d0:a2:d2:fb:
                    5f:ed:3e:b6:79:3a:aa:9a:b2:50:58:41:7c:9b:ad:
                    30:34:2a:4b:5b:c3:82:80:10:3a:9b:8c:03:05:b4:
                    7e:e3:ac:0c:4e:cf:96:41:2b:a5:8b:7b:ad:c6:5f:
                    6c:61:0a:9f:50:eb:23:f6:26:5e:85:64:c4:d7:5a:
                    54:09:66:c5:f9:55:5d:49:5a:6c:9a:07:8c:d1:d5:
                    79:da:b3:da:7e:22:11:eb:23:ab:97:d8:5d:79:75:
                    3a:53:09:59:56:6c:2a:46:95:d1:8c:22:e6:92:b2:
                    d5:80:79:68:04:13:15:17:95:bf:d4:a1:7b:ce:6f:
                    91:09:23:c7:98:34:c6:58:42:ff:a2:9e:81:68:38:
                    3f:09:37:35:2b:6d:ba:9e:3f:69:0f:10:da:0e:2a:
                    22:58:7c:cb:5f:25:c3:59:ba:34:a5:87:23:a7:11:
                    de:51:dd:b8:ed:95:48:06:32:11:38:da:69:d9:3a:
                    72:d5:24:df:9e:21:54:0f:13:07:b5:bc:16:25:9e:
                    ca:b1:f0:4e:74:50:18:f7:4b:aa:f7:34:89:32:9d:
                    bc:53:a8:e8:ca:14:0e:6c:1f:fc:a6:b5:ff:cc:06:
                    7e:19
                Exponent: 65537 (0x10001)
        X509v3 extensions:
            X509v3 Key Usage: critical
                Digital Signature, Key Encipherment
            X509v3 Extended Key Usage: 
                TLS Web Server Authentication
            X509v3 Basic Constraints: critical
                CA:FALSE
            X509v3 Authority Key Identifier: 
                5D:B9:14:05:F3:93:AD:AE:0E:45:F8:60:E0:FD:8E:8D:4E:09:D6:8F
            X509v3 Subject Alternative Name: 
                DNS:controlplane, DNS:kubernetes, DNS:kubernetes.default, DNS:kubernetes.default.svc, DNS:kubernetes.default.svc.cluster.local, IP Address:10.96.0.1, IP Address:192.22.143.6
    Signature Algorithm: sha256WithRSAEncryption
    Signature Value:
        b4:dd:20:1f:1e:c5:6b:c3:68:b1:3e:8b:6f:2e:b2:2e:06:89:
        32:70:59:f7:7a:a6:8b:63:7f:a9:2f:92:17:44:fb:7c:db:14:
        ec:62:9c:75:3a:9f:b8:03:7a:f3:38:a3:97:60:21:7b:30:22:
        ac:c6:11:c8:1a:e2:ae:f8:0e:ec:62:39:65:04:a1:0d:eb:70:
        af:2e:ec:43:d1:6e:46:6e:c2:64:fd:c8:11:94:57:51:b7:a5:
        cd:47:3e:3b:a6:7c:be:cc:a9:f3:ad:31:29:58:37:64:b2:b4:
        45:20:58:7b:1a:e7:90:7b:50:fc:4e:b2:68:97:05:50:3e:ae:
        0e:ee:38:5d:c2:ea:92:e7:06:1e:91:c1:17:7a:bb:68:2e:27:
        c9:32:88:cc:6a:aa:2f:ef:81:8d:4a:3b:b8:c8:ac:5f:6d:b0:
        20:a4:2c:94:f1:8d:36:f4:a0:f3:5c:d9:19:32:ed:d6:07:bf:
        d9:5c:e4:36:77:e6:c1:5a:72:8f:40:7c:f6:54:77:9d:2e:35:
        ff:4c:a5:8f:eb:15:4d:06:be:b6:0c:4d:84:fb:eb:08:7a:2e:
        c5:c0:05:e8:09:35:ab:81:30:d4:aa:68:7e:b3:14:f1:49:76:
        ee:3c:ae:c1:b0:f9:10:e4:66:40:a2:bf:7b:75:91:fd:b4:69:
        6f:37:2c:f6
-----BEGIN CERTIFICATE-----
MIIDjDCCAnSgAwIBAgIIST1ur0lDQSEwDQYJKoZIhvcNAQELBQAwFTETMBEGA1UE
AxMKa3ViZXJuZXRlczAeFw0yNDEwMTgxMjMyMzFaFw0yNTEwMTgxMjM3MzFaMBkx
FzAVBgNVBAMTDmt1YmUtYXBpc2VydmVyMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8A
MIIBCgKCAQEAr6/iRjcrAu8CzKGUOKYWBSkSO6iMsCGlpdCi0vtf7T62eTqqmrJQ
WEF8m60wNCpLW8OCgBA6m4wDBbR+46wMTs+WQSuli3utxl9sYQqfUOsj9iZehWTE
11pUCWbF+VVdSVpsmgeM0dV52rPafiIR6yOrl9hdeXU6UwlZVmwqRpXRjCLmkrLV
gHloBBMVF5W/1KF7zm+RCSPHmDTGWEL/op6BaDg/CTc1K226nj9pDxDaDioiWHzL
XyXDWbo0pYcjpxHeUd247ZVIBjIRONpp2Tpy1STfniFUDxMHtbwWJZ7KsfBOdFAY
90uq9zSJMp28U6joyhQObB/8prX/zAZ+GQIDAQABo4HbMIHYMA4GA1UdDwEB/wQE
AwIFoDATBgNVHSUEDDAKBggrBgEFBQcDATAMBgNVHRMBAf8EAjAAMB8GA1UdIwQY
MBaAFF25FAXzk62uDkX4YOD9jo1OCdaPMIGBBgNVHREEejB4ggxjb250cm9scGxh
bmWCCmt1YmVybmV0ZXOCEmt1YmVybmV0ZXMuZGVmYXVsdIIWa3ViZXJuZXRlcy5k
ZWZhdWx0LnN2Y4Ika3ViZXJuZXRlcy5kZWZhdWx0LnN2Yy5jbHVzdGVyLmxvY2Fs
hwQKYAABhwTAFo8GMA0GCSqGSIb3DQEBCwUAA4IBAQC03SAfHsVrw2ixPotvLrIu
BokycFn3eqaLY3+pL5IXRPt82xTsYpx1Op+4A3rzOKOXYCF7MCKsxhHIGuKu+A7s
YjllBKEN63CvLuxD0W5GbsJk/cgRlFdRt6XNRz47pny+zKnzrTEpWDdksrRFIFh7
GueQe1D8TrJolwVQPq4O7jhdwuqS5wYekcEXertoLifJMojMaqov74GNSju4yKxf
bbAgpCyU8Y029KDzXNkZMu3WB7/ZXOQ2d+bBWnKPQHz2VHedLjX/TKWP6xVNBr62
DE2E++sIei7FwAXoCTWrgTDUqmh+sxTxSXbuPK7BsPkQ5GZAor97dZH9tGlvNyz2
-----END CERTIFICATE-----

controlplane ~ ➜  
```

#### How long, from the issued date, is the Root CA Certificate valid for?

Run the command openssl x509 -in /etc/kubernetes/pki/ca.crt -text and look for the validity.

```ruby

controlplane ~ ➜  openssl x509 -in /etc/kubernetes/pki/ca.crt -text
Certificate:
    Data:
        Version: 3 (0x2)
        Serial Number: 5035326985740804930 (0x45e113371904e342)
        Signature Algorithm: sha256WithRSAEncryption
        Issuer: CN = kubernetes
        Validity
            Not Before: Oct 18 12:32:31 2024 GMT
            Not After : Oct 16 12:37:31 2034 GMT
        Subject: CN = kubernetes
        Subject Public Key Info:
            Public Key Algorithm: rsaEncryption
                Public-Key: (2048 bit)
                Modulus:
                    00:d9:6f:ec:65:62:e2:9d:e8:02:2b:e3:11:84:5c:
                    48:29:f3:6b:59:8d:f1:08:9a:31:a0:22:e2:ad:bd:
                    9b:d0:8d:65:ef:96:ea:95:75:e1:81:f9:47:a6:f0:
                    a1:65:3e:7d:80:c1:58:10:80:73:18:c3:32:0a:5a:
                    b4:fd:b9:9c:8e:8e:6a:d1:90:be:f6:9d:d5:26:fa:
                    74:d7:87:f4:58:9d:9a:4c:3d:5f:7c:31:6c:69:48:
                    0f:e3:55:36:fc:bb:82:50:75:c2:50:10:1a:11:24:
                    1d:26:89:d5:fa:e7:a0:9e:9c:0a:e4:3a:95:eb:8f:
                    53:88:9d:0d:ed:ea:96:26:93:a3:81:d0:cd:37:02:
                    81:40:43:52:72:9d:58:75:69:68:87:9e:8a:f9:8b:
                    6f:f0:d6:9a:56:3c:b1:30:c6:de:1b:a0:39:29:f1:
                    95:19:4b:d7:8c:c4:99:88:55:19:99:be:0a:c8:ff:
                    d3:3d:f1:01:38:77:d8:4b:2e:9c:b7:8c:07:30:93:
                    04:8c:f7:09:f7:8f:6c:ae:3c:bc:d7:88:66:29:c3:
                    d0:80:8f:f7:ee:cf:15:3a:32:c6:7d:b4:ff:c1:37:
                    e7:f7:05:9c:62:1c:57:f7:74:6b:fe:0c:67:db:af:
                    4b:e4:a9:ac:79:28:8e:37:33:9e:55:e8:bc:a4:91:
                    e6:c7
                Exponent: 65537 (0x10001)
        X509v3 extensions:
            X509v3 Key Usage: critical
                Digital Signature, Key Encipherment, Certificate Sign
            X509v3 Basic Constraints: critical
                CA:TRUE
            X509v3 Subject Key Identifier: 
                5D:B9:14:05:F3:93:AD:AE:0E:45:F8:60:E0:FD:8E:8D:4E:09:D6:8F
            X509v3 Subject Alternative Name: 
                DNS:kubernetes
    Signature Algorithm: sha256WithRSAEncryption
    Signature Value:
        24:71:6e:cf:3f:87:9c:cd:ce:3b:48:d1:e1:34:08:30:59:94:
        10:f0:b6:de:2f:b9:10:bc:5b:12:53:19:2f:4f:b4:ee:65:96:
        8b:0b:8e:d3:c6:9a:45:49:d4:33:0a:9a:69:51:65:23:10:2a:
        50:37:0e:f4:61:3b:02:c9:53:bf:17:33:69:e0:84:96:cc:f8:
        28:e4:15:59:a6:63:1b:56:13:7a:46:8c:eb:51:3f:96:3f:3b:
        33:b3:1f:77:6f:df:64:6f:cb:82:1f:49:5c:29:b1:4a:7d:76:
        ab:b5:51:21:80:22:bf:29:a7:3c:8c:bd:7e:f1:b3:28:26:12:
        09:ef:4c:99:71:f3:5a:e3:98:0a:a2:5c:4d:d2:42:e8:56:a0:
        14:df:52:3c:49:25:b2:e9:b8:09:2f:dc:83:14:0f:c6:f7:ff:
        2b:b8:58:08:78:6e:75:09:2c:d9:b2:bc:4e:be:09:e3:82:af:
        05:c9:23:64:89:14:63:7f:31:52:03:42:7d:49:af:0b:07:eb:
        86:cb:c2:f0:f6:66:ec:95:6e:61:05:7a:1f:14:b8:df:c9:26:
        f6:97:65:06:d3:ae:49:f2:62:b1:0a:ec:19:f3:d3:aa:1e:af:
        eb:ed:65:70:ff:c1:97:54:d8:74:c0:b9:c9:eb:2e:3f:d7:33:
        cf:dc:1f:5f
-----BEGIN CERTIFICATE-----
MIIDBTCCAe2gAwIBAgIIReETNxkE40IwDQYJKoZIhvcNAQELBQAwFTETMBEGA1UE
AxMKa3ViZXJuZXRlczAeFw0yNDEwMTgxMjMyMzFaFw0zNDEwMTYxMjM3MzFaMBUx
EzARBgNVBAMTCmt1YmVybmV0ZXMwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEK
AoIBAQDZb+xlYuKd6AIr4xGEXEgp82tZjfEImjGgIuKtvZvQjWXvluqVdeGB+Uem
8KFlPn2AwVgQgHMYwzIKWrT9uZyOjmrRkL72ndUm+nTXh/RYnZpMPV98MWxpSA/j
VTb8u4JQdcJQEBoRJB0midX656CenArkOpXrj1OInQ3t6pYmk6OB0M03AoFAQ1Jy
nVh1aWiHnor5i2/w1ppWPLEwxt4boDkp8ZUZS9eMxJmIVRmZvgrI/9M98QE4d9hL
Lpy3jAcwkwSM9wn3j2yuPLzXiGYpw9CAj/fuzxU6MsZ9tP/BN+f3BZxiHFf3dGv+
DGfbr0vkqax5KI43M55V6LykkebHAgMBAAGjWTBXMA4GA1UdDwEB/wQEAwICpDAP
BgNVHRMBAf8EBTADAQH/MB0GA1UdDgQWBBRduRQF85Otrg5F+GDg/Y6NTgnWjzAV
BgNVHREEDjAMggprdWJlcm5ldGVzMA0GCSqGSIb3DQEBCwUAA4IBAQAkcW7PP4ec
zc47SNHhNAgwWZQQ8LbeL7kQvFsSUxkvT7TuZZaLC47TxppFSdQzCpppUWUjECpQ
Nw70YTsCyVO/FzNp4ISWzPgo5BVZpmMbVhN6RozrUT+WPzszsx93b99kb8uCH0lc
KbFKfXartVEhgCK/Kac8jL1+8bMoJhIJ70yZcfNa45gKolxN0kLoVqAU31I8SSWy
6bgJL9yDFA/G9/8ruFgIeG51CSzZsrxOvgnjgq8FySNkiRRjfzFSA0J9Sa8LB+uG
y8Lw9mbslW5hBXofFLjfySb2l2UG065J8mKxCuwZ89OqHq/r7WVw/8GXVNh0wLnJ
6y4/1zPP3B9f
-----END CERTIFICATE-----

controlplane ~ ➜  
```

#### Kubectl suddenly stops responding to your commands. Check it out! Someone recently modified the /etc/kubernetes/manifests/etcd.yaml file


You are asked to investigate and fix the issue. Once you fix the issue wait for sometime for kubectl to respond. Check the logs of the ETCD container.

The certificate file used here is incorrect. It is set to /etc/kubernetes/pki/etcd/server-certificate.crt which does not exist. As we saw in the previous questions the correct path should be /etc/kubernetes/pki/etcd/server.crt.
```
root@controlplane:~# ls -l /etc/kubernetes/pki/etcd/server* | grep .crt
-rw-r--r-- 1 root root 1188 May 20 00:41 /etc/kubernetes/pki/etcd/server.crt
root@controlplane:~#

```
Update the YAML file with the correct certificate path and wait for the ETCD pod to be recreated. wait for the kube-apiserver to get to a Ready state.


NOTE: It may take a few minutes for the kubectl commands to work again so please be patient.

```ruby
controlplane ~ ✖ cat /etc/kubernetes/manifests/etcd.yaml 
apiVersion: v1
kind: Pod
metadata:
  annotations:
    kubeadm.kubernetes.io/etcd.advertise-client-urls: https://192.22.143.6:2379
  creationTimestamp: null
  labels:
    component: etcd
    tier: control-plane
  name: etcd
  namespace: kube-system
spec:
  containers:
  - command:
    - etcd
    - --advertise-client-urls=https://192.22.143.6:2379
    - --cert-file=/etc/kubernetes/pki/etcd/server-certificate.crt
    - --client-cert-auth=true
    - --data-dir=/var/lib/etcd
    - --experimental-initial-corrupt-check=true
    - --experimental-watch-progress-notify-interval=5s
    - --initial-advertise-peer-urls=https://192.22.143.6:2380
    - --initial-cluster=controlplane=https://192.22.143.6:2380
    - --key-file=/etc/kubernetes/pki/etcd/server.key
    - --listen-client-urls=https://127.0.0.1:2379,https://192.22.143.6:2379
    - --listen-metrics-urls=http://127.0.0.1:2381
    - --listen-peer-urls=https://192.22.143.6:2380
    - --name=controlplane
    - --peer-cert-file=/etc/kubernetes/pki/etcd/peer.crt
    - --peer-client-cert-auth=true
    - --peer-key-file=/etc/kubernetes/pki/etcd/peer.key
    - --peer-trusted-ca-file=/etc/kubernetes/pki/etcd/ca.crt
    - --snapshot-count=10000
    - --trusted-ca-file=/etc/kubernetes/pki/etcd/ca.crt
    image: registry.k8s.io/etcd:3.5.15-0
    imagePullPolicy: IfNotPresent
    livenessProbe:
      failureThreshold: 8
      httpGet:
        host: 127.0.0.1
        path: /livez
        port: 2381
        scheme: HTTP
      initialDelaySeconds: 10
      periodSeconds: 10
      timeoutSeconds: 15
    name: etcd
    readinessProbe:
      failureThreshold: 3
      httpGet:
        host: 127.0.0.1
        path: /readyz
        port: 2381
        scheme: HTTP
      periodSeconds: 1
      timeoutSeconds: 15
    resources:
      requests:
        cpu: 100m
        memory: 100Mi
    startupProbe:
      failureThreshold: 24
      httpGet:
        host: 127.0.0.1
        path: /readyz
        port: 2381
        scheme: HTTP
      initialDelaySeconds: 10
      periodSeconds: 10
      timeoutSeconds: 15
    volumeMounts:
    - mountPath: /var/lib/etcd
      name: etcd-data
    - mountPath: /etc/kubernetes/pki/etcd
      name: etcd-certs
  hostNetwork: true
  priority: 2000001000
  priorityClassName: system-node-critical
  securityContext:
    seccompProfile:
      type: RuntimeDefault
  volumes:
  - hostPath:
      path: /etc/kubernetes/pki/etcd
      type: DirectoryOrCreate
    name: etcd-certs
  - hostPath:
      path: /var/lib/etcd
      type: DirectoryOrCreate
    name: etcd-data
status: {}

controlplane ~ ➜  cat /etc/kubernetes/pki/etcd/server-certificate.crt
cat: /etc/kubernetes/pki/etcd/server-certificate.crt: No such file or directory

controlplane ~ ✖ cd /etc/kubernetes/pki/etcd/

controlplane kubernetes/pki/etcd ➜  ls
ca.crt  healthcheck-client.crt  peer.crt  server.crt
ca.key  healthcheck-client.key  peer.key  server.key

controlplane kubernetes/pki/etcd ➜  cd ~

controlplane ~ ➜  cat /etc/kubernetes/manifests/etcd.yaml 
apiVersion: v1
kind: Pod
metadata:
  annotations:
    kubeadm.kubernetes.io/etcd.advertise-client-urls: https://192.22.143.6:2379
  creationTimestamp: null
  labels:
    component: etcd
    tier: control-plane
  name: etcd
  namespace: kube-system
spec:
  containers:
  - command:
    - etcd
    - --advertise-client-urls=https://192.22.143.6:2379
    - --cert-file=/etc/kubernetes/pki/etcd/server-certificate.crt
    - --client-cert-auth=true
    - --data-dir=/var/lib/etcd
    - --experimental-initial-corrupt-check=true
    - --experimental-watch-progress-notify-interval=5s
    - --initial-advertise-peer-urls=https://192.22.143.6:2380
    - --initial-cluster=controlplane=https://192.22.143.6:2380
    - --key-file=/etc/kubernetes/pki/etcd/server.key
    - --listen-client-urls=https://127.0.0.1:2379,https://192.22.143.6:2379
    - --listen-metrics-urls=http://127.0.0.1:2381
    - --listen-peer-urls=https://192.22.143.6:2380
    - --name=controlplane
    - --peer-cert-file=/etc/kubernetes/pki/etcd/peer.crt
    - --peer-client-cert-auth=true
    - --peer-key-file=/etc/kubernetes/pki/etcd/peer.key
    - --peer-trusted-ca-file=/etc/kubernetes/pki/etcd/ca.crt
    - --snapshot-count=10000
    - --trusted-ca-file=/etc/kubernetes/pki/etcd/ca.crt
    image: registry.k8s.io/etcd:3.5.15-0
    imagePullPolicy: IfNotPresent
    livenessProbe:
      failureThreshold: 8
      httpGet:
        host: 127.0.0.1
        path: /livez
        port: 2381
        scheme: HTTP
      initialDelaySeconds: 10
      periodSeconds: 10
      timeoutSeconds: 15
    name: etcd
    readinessProbe:
      failureThreshold: 3
      httpGet:
        host: 127.0.0.1
        path: /readyz
        port: 2381
        scheme: HTTP
      periodSeconds: 1
      timeoutSeconds: 15
    resources:
      requests:
        cpu: 100m
        memory: 100Mi
    startupProbe:
      failureThreshold: 24
      httpGet:
        host: 127.0.0.1
        path: /readyz
        port: 2381
        scheme: HTTP
      initialDelaySeconds: 10
      periodSeconds: 10
      timeoutSeconds: 15
    volumeMounts:
    - mountPath: /var/lib/etcd
      name: etcd-data
    - mountPath: /etc/kubernetes/pki/etcd
      name: etcd-certs
  hostNetwork: true
  priority: 2000001000
  priorityClassName: system-node-critical
  securityContext:
    seccompProfile:
      type: RuntimeDefault
  volumes:
  - hostPath:
      path: /etc/kubernetes/pki/etcd
      type: DirectoryOrCreate
    name: etcd-certs
  - hostPath:
      path: /var/lib/etcd
      type: DirectoryOrCreate
    name: etcd-data
status: {}

controlplane ~ ➜  vi /etc/kubernetes/manifests/etcd.yaml 

controlplane ~ ➜  cat /etc/kubernetes/manifests/etcd.yaml 
apiVersion: v1
kind: Pod
metadata:
  annotations:
    kubeadm.kubernetes.io/etcd.advertise-client-urls: https://192.22.143.6:2379
  creationTimestamp: null
  labels:
    component: etcd
    tier: control-plane
  name: etcd
  namespace: kube-system
spec:
  containers:
  - command:
    - etcd
    - --advertise-client-urls=https://192.22.143.6:2379
    - --cert-file=/etc/kubernetes/pki/etcd/server.crt
    - --client-cert-auth=true
    - --data-dir=/var/lib/etcd
    - --experimental-initial-corrupt-check=true
    - --experimental-watch-progress-notify-interval=5s
    - --initial-advertise-peer-urls=https://192.22.143.6:2380
    - --initial-cluster=controlplane=https://192.22.143.6:2380
    - --key-file=/etc/kubernetes/pki/etcd/server.key
    - --listen-client-urls=https://127.0.0.1:2379,https://192.22.143.6:2379
    - --listen-metrics-urls=http://127.0.0.1:2381
    - --listen-peer-urls=https://192.22.143.6:2380
    - --name=controlplane
    - --peer-cert-file=/etc/kubernetes/pki/etcd/peer.crt
    - --peer-client-cert-auth=true
    - --peer-key-file=/etc/kubernetes/pki/etcd/peer.key
    - --peer-trusted-ca-file=/etc/kubernetes/pki/etcd/ca.crt
    - --snapshot-count=10000
    - --trusted-ca-file=/etc/kubernetes/pki/etcd/ca.crt
    image: registry.k8s.io/etcd:3.5.15-0
    imagePullPolicy: IfNotPresent
    livenessProbe:
      failureThreshold: 8
      httpGet:
        host: 127.0.0.1
        path: /livez
        port: 2381
        scheme: HTTP
      initialDelaySeconds: 10
      periodSeconds: 10
      timeoutSeconds: 15
    name: etcd
    readinessProbe:
      failureThreshold: 3
      httpGet:
        host: 127.0.0.1
        path: /readyz
        port: 2381
        scheme: HTTP
      periodSeconds: 1
      timeoutSeconds: 15
    resources:
      requests:
        cpu: 100m
        memory: 100Mi
    startupProbe:
      failureThreshold: 24
      httpGet:
        host: 127.0.0.1
        path: /readyz
        port: 2381
        scheme: HTTP
      initialDelaySeconds: 10
      periodSeconds: 10
      timeoutSeconds: 15
    volumeMounts:
    - mountPath: /var/lib/etcd
      name: etcd-data
    - mountPath: /etc/kubernetes/pki/etcd
      name: etcd-certs
  hostNetwork: true
  priority: 2000001000
  priorityClassName: system-node-critical
  securityContext:
    seccompProfile:
      type: RuntimeDefault
  volumes:
  - hostPath:
      path: /etc/kubernetes/pki/etcd
      type: DirectoryOrCreate
    name: etcd-certs
  - hostPath:
      path: /var/lib/etcd
      type: DirectoryOrCreate
    name: etcd-data
status: {}

controlplane ~ ➜


controlplane ~ ➜  k get pod -n kube-system 
NAME                                   READY   STATUS    RESTARTS        AGE
coredns-77d6fd4654-7h78m               1/1     Running   0               39m
coredns-77d6fd4654-gjc9c               1/1     Running   0               39m
etcd-controlplane                      1/1     Running   0               40m
kube-apiserver-controlplane            1/1     Running   5 (2m21s ago)   40m
kube-controller-manager-controlplane   1/1     Running   1 (6m11s ago)   40m
kube-proxy-qmvrq                       1/1     Running   0               39m
kube-scheduler-controlplane            1/1     Running   1 (6m6s ago)    40m

controlplane ~ ➜

```
### The kube-api server stopped again! Check it out. Inspect the kube-api server logs and identify the root cause and fix the issue.


Run crictl ps -a command to identify the kube-api server container. Run crictl logs container-id command to view the logs.



### If we inspect the kube-apiserver container on the controlplane, we can see that it is frequently exiting.


```ruby


root@controlplane:~# crictl ps -a | grep kube-apiserver
1fb242055cff8       529072250ccc6       About a minute ago   Exited              kube-apiserver            3                   ed2174865a416       kube-apiserver-controlplane

```
If we now inspect the logs of this exited container, we would see the following errors:


```ruby
root@controlplane:~# crictl logs --tail=2 1fb242055cff8  
W0916 14:19:44.771920       1 clientconn.go:1331] [core] grpc: addrConn.createTransport failed to connect to {127.0.0.1:2379 127.0.0.1 <nil> 0 <nil>}. Err: connection error: desc = "transport: authentication handshake failed: x509: certificate signed by unknown authority". Reconnecting...
E0916 14:19:48.689303       1 run.go:74] "command failed" err="context deadline exceeded"

```r
This indicates an issue with the ETCD CA certificate used by the kube-apiserver. Correct it to use the file /etc/kubernetes/pki/etcd/ca.crt.

Once the YAML file has been saved, wait for the kube-apiserver pod to be Ready. This can take a couple of minutes.


```ruby
controlplane ~ ➜  k get pod
The connection to the server controlplane:6443 was refused - did you specify the right host or port?

controlplane ~ ✖ crictl ps -a
CONTAINER           IMAGE               CREATED             STATE               NAME                      ATTEMPT             POD ID              POD
18553ab606c5b       604f5db92eaa8       12 seconds ago      Running             kube-apiserver            0                   70a50831f4f59       kube-apiserver-controlplane
798045beec025       1766f54c897f0       24 seconds ago      Running             kube-scheduler            2                   d52c93f096079       kube-scheduler-controlplane
e5beed8cd4a6d       045733566833c       28 seconds ago      Running             kube-controller-manager   2                   3f45e3732d325       kube-controller-manager-controlplane
062bdfb10b6de       2e96e5913fc06       3 minutes ago       Running             etcd                      0                   da86c9d438c1d       etcd-controlplane
eee5fd513ad3c       1766f54c897f0       8 minutes ago       Exited              kube-scheduler            1                   d52c93f096079       kube-scheduler-controlplane
6f27a19a1d7dc       045733566833c       8 minutes ago       Exited              kube-controller-manager   1                   3f45e3732d325       kube-controller-manager-controlplane
1c127560ff0d2       ead0a4a53df89       41 minutes ago      Running             coredns                   0                   dcb1f099bbd76       coredns-77d6fd4654-gjc9c
09ba1480ea727       ead0a4a53df89       41 minutes ago      Running             coredns                   0                   ec83d0a5b8e31       coredns-77d6fd4654-7h78m
56595a7708416       01cdfa8dd262f       41 minutes ago      Running             kube-flannel              0                   c7cb23c7bb66d       kube-flannel-ds-962zc
343daf7f56e09       01cdfa8dd262f       41 minutes ago      Exited              install-cni               0                   c7cb23c7bb66d       kube-flannel-ds-962zc
612eb694b0b0f       a55d1bad692b7       41 minutes ago      Exited              install-cni-plugin        0                   c7cb23c7bb66d       kube-flannel-ds-962zc
cb51d2a0ff7d9       ad83b2ca7b09e       41 minutes ago      Running             kube-proxy                0                   3b6a86cffd4b9       kube-proxy-qmvrq

controlplane ~ ➜  crictl ps -a
CONTAINER           IMAGE               CREATED              STATE               NAME                      ATTEMPT             POD ID              POD
d32bf3d9fcb05       604f5db92eaa8       40 seconds ago       Exited              kube-apiserver            2                   70a50831f4f59       kube-apiserver-controlplane
798045beec025       1766f54c897f0       About a minute ago   Running             kube-scheduler            2                   d52c93f096079       kube-scheduler-controlplane
e5beed8cd4a6d       045733566833c       About a minute ago   Running             kube-controller-manager   2                   3f45e3732d325       kube-controller-manager-controlplane
062bdfb10b6de       2e96e5913fc06       4 minutes ago        Running             etcd                      0                   da86c9d438c1d       etcd-controlplane
eee5fd513ad3c       1766f54c897f0       9 minutes ago        Exited              kube-scheduler            1                   d52c93f096079       kube-scheduler-controlplane
6f27a19a1d7dc       045733566833c       9 minutes ago        Exited              kube-controller-manager   1                   3f45e3732d325       kube-controller-manager-controlplane
1c127560ff0d2       ead0a4a53df89       43 minutes ago       Running             coredns                   0                   dcb1f099bbd76       coredns-77d6fd4654-gjc9c
09ba1480ea727       ead0a4a53df89       43 minutes ago       Running             coredns                   0                   ec83d0a5b8e31       coredns-77d6fd4654-7h78m
56595a7708416       01cdfa8dd262f       43 minutes ago       Running             kube-flannel              0                   c7cb23c7bb66d       kube-flannel-ds-962zc
343daf7f56e09       01cdfa8dd262f       43 minutes ago       Exited              install-cni               0                   c7cb23c7bb66d       kube-flannel-ds-962zc
612eb694b0b0f       a55d1bad692b7       43 minutes ago       Exited              install-cni-plugin        0                   c7cb23c7bb66d       kube-flannel-ds-962zc
cb51d2a0ff7d9       ad83b2ca7b09e       43 minutes ago       Running             kube-proxy                0                   3b6a86cffd4b9       kube-proxy-qmvrq

controlplane ~ ➜  crictl ps -a | grep kube-api-server

controlplane ~ ✖ crictl ps -a | grep kube-apiserver
291637d458613       604f5db92eaa8       35 seconds ago      Exited              kube-apiserver            3                   70a50831f4f59       kube-apiserver-controlplane

controlplane ~ ➜  crictl logs 2916
I1018 13:21:20.144708       1 options.go:228] external host was not specified, using 192.22.143.6
I1018 13:21:20.146780       1 server.go:142] Version: v1.31.0
I1018 13:21:20.146812       1 server.go:144] "Golang settings" GOGC="" GOMAXPROCS="" GOTRACEBACK=""
I1018 13:21:20.561983       1 shared_informer.go:313] Waiting for caches to sync for node_authorizer
W1018 13:21:20.562648       1 logging.go:55] [core] [Channel #2 SubChannel #4]grpc: addrConn.createTransport failed to connect to {Addr: "127.0.0.1:2379", ServerName: "127.0.0.1:2379", }. Err: connection error: desc = "transport: authentication handshake failed: tls: failed to verify certificate: x509: certificate signed by unknown authority"
W1018 13:21:20.564858       1 logging.go:55] [core] [Channel #1 SubChannel #3]grpc: addrConn.createTransport failed to connect to {Addr: "127.0.0.1:2379", ServerName: "127.0.0.1:2379", }. Err: connection error: desc = "transport: authentication handshake failed: tls: failed to verify certificate: x509: certificate signed by unknown authority"
I1018 13:21:20.572049       1 shared_informer.go:313] Waiting for caches to sync for *generic.policySource[*k8s.io/api/admissionregistration/v1.ValidatingAdmissionPolicy,*k8s.io/api/admissionregistration/v1.ValidatingAdmissionPolicyBinding,k8s.io/apiserver/pkg/admission/plugin/policy/validating.Validator]
I1018 13:21:20.574768       1 plugins.go:157] Loaded 12 mutating admission controller(s) successfully in the following order: NamespaceLifecycle,LimitRanger,ServiceAccount,NodeRestriction,TaintNodesByCondition,Priority,DefaultTolerationSeconds,DefaultStorageClass,StorageObjectInUseProtection,RuntimeClass,DefaultIngressClass,MutatingAdmissionWebhook.
I1018 13:21:20.574792       1 plugins.go:160] Loaded 13 validating admission controller(s) successfully in the following order: LimitRanger,ServiceAccount,PodSecurity,Priority,PersistentVolumeClaimResize,RuntimeClass,CertificateApproval,CertificateSigning,ClusterTrustBundleAttest,CertificateSubjectRestriction,ValidatingAdmissionPolicy,ValidatingAdmissionWebhook,ResourceQuota.
I1018 13:21:20.574977       1 instance.go:232] Using reconciler: lease
W1018 13:21:20.578993       1 logging.go:55] [core] [Channel #5 SubChannel #6]grpc: addrConn.createTransport failed to connect to {Addr: "127.0.0.1:2379", ServerName: "127.0.0.1:2379", }. Err: connection error: desc = "transport: authentication handshake failed: tls: failed to verify certificate: x509: certificate signed by unknown authority"
W1018 13:21:21.567335       1 logging.go:55] [core] [Channel #2 SubChannel #4]grpc: addrConn.createTransport failed to connect to {Addr: "127.0.0.1:2379", ServerName: "127.0.0.1:2379", }. Err: connection error: desc = "transport: authentication handshake failed: tls: failed to verify certificate: x509: certificate signed by unknown authority"
W1018 13:21:21.569442       1 logging.go:55] [core] [Channel #1 SubChannel #3]grpc: addrConn.createTransport failed to connect to {Addr: "127.0.0.1:2379", ServerName: "127.0.0.1:2379", }. Err: connection error: desc = "transport: authentication handshake failed: tls: failed to verify certificate: x509: certificate signed by unknown authority"
W1018 13:21:21.582585       1 logging.go:55] [core] [Channel #5 SubChannel #6]grpc: addrConn.createTransport failed to connect to {Addr: "127.0.0.1:2379", ServerName: "127.0.0.1:2379", }. Err: connection error: desc = "transport: authentication handshake failed: tls: failed to verify certificate: x509: certificate signed by unknown authority"
W1018 13:21:23.189132       1 logging.go:55] [core] [Channel #2 SubChannel #4]grpc: addrConn.createTransport failed to connect to {Addr: "127.0.0.1:2379", ServerName: "127.0.0.1:2379", }. Err: connection error: desc = "transport: authentication handshake failed: tls: failed to verify certificate: x509: certificate signed by unknown authority"
W1018 13:21:23.315349       1 logging.go:55] [core] [Channel #5 SubChannel #6]grpc: addrConn.createTransport failed to connect to {Addr: "127.0.0.1:2379", ServerName: "127.0.0.1:2379", }. Err: connection error: desc = "transport: authentication handshake failed: tls: failed to verify certificate: x509: certificate signed by unknown authority"
W1018 13:21:23.407952       1 logging.go:55] [core] [Channel #1 SubChannel #3]grpc: addrConn.createTransport failed to connect to {Addr: "127.0.0.1:2379", ServerName: "127.0.0.1:2379", }. Err: connection error: desc = "transport: authentication handshake failed: tls: failed to verify certificate: x509: certificate signed by unknown authority"
W1018 13:21:25.518584       1 logging.go:55] [core] [Channel #5 SubChannel #6]grpc: addrConn.createTransport failed to connect to {Addr: "127.0.0.1:2379", ServerName: "127.0.0.1:2379", }. Err: connection error: desc = "transport: authentication handshake failed: tls: failed to verify certificate: x509: certificate signed by unknown authority"
W1018 13:21:25.910736       1 logging.go:55] [core] [Channel #2 SubChannel #4]grpc: addrConn.createTransport failed to connect to {Addr: "127.0.0.1:2379", ServerName: "127.0.0.1:2379", }. Err: connection error: desc = "transport: authentication handshake failed: tls: failed to verify certificate: x509: certificate signed by unknown authority"
W1018 13:21:26.254323       1 logging.go:55] [core] [Channel #1 SubChannel #3]grpc: addrConn.createTransport failed to connect to {Addr: "127.0.0.1:2379", ServerName: "127.0.0.1:2379", }. Err: connection error: desc = "transport: authentication handshake failed: tls: failed to verify certificate: x509: certificate signed by unknown authority"
W1018 13:21:29.757774       1 logging.go:55] [core] [Channel #5 SubChannel #6]grpc: addrConn.createTransport failed to connect to {Addr: "127.0.0.1:2379", ServerName: "127.0.0.1:2379", }. Err: connection error: desc = "transport: authentication handshake failed: tls: failed to verify certificate: x509: certificate signed by unknown authority"
W1018 13:21:30.323535       1 logging.go:55] [core] [Channel #2 SubChannel #4]grpc: addrConn.createTransport failed to connect to {Addr: "127.0.0.1:2379", ServerName: "127.0.0.1:2379", }. Err: connection error: desc = "transport: authentication handshake failed: tls: failed to verify certificate: x509: certificate signed by unknown authority"
W1018 13:21:30.710073       1 logging.go:55] [core] [Channel #1 SubChannel #3]grpc: addrConn.createTransport failed to connect to {Addr: "127.0.0.1:2379", ServerName: "127.0.0.1:2379", }. Err: connection error: desc = "transport: authentication handshake failed: tls: failed to verify certificate: x509: certificate signed by unknown authority"
W1018 13:21:36.461172       1 logging.go:55] [core] [Channel #1 SubChannel #3]grpc: addrConn.createTransport failed to connect to {Addr: "127.0.0.1:2379", ServerName: "127.0.0.1:2379", }. Err: connection error: desc = "transport: authentication handshake failed: tls: failed to verify certificate: x509: certificate signed by unknown authority"
W1018 13:21:37.014056       1 logging.go:55] [core] [Channel #5 SubChannel #6]grpc: addrConn.createTransport failed to connect to {Addr: "127.0.0.1:2379", ServerName: "127.0.0.1:2379", }. Err: connection error: desc = "transport: authentication handshake failed: tls: failed to verify certificate: x509: certificate signed by unknown authority"
W1018 13:21:37.621664       1 logging.go:55] [core] [Channel #2 SubChannel #4]grpc: addrConn.createTransport failed to connect to {Addr: "127.0.0.1:2379", ServerName: "127.0.0.1:2379", }. Err: connection error: desc = "transport: authentication handshake failed: tls: failed to verify certificate: x509: certificate signed by unknown authority"
F1018 13:21:40.578401       1 instance.go:225] Error creating leases: error creating storage factory: context deadline exceeded

controlplane ~ ➜  

controlplane ~ ➜  crictl ps -a
CONTAINER           IMAGE               CREATED             STATE               NAME                      ATTEMPT             POD ID              POD
c49dc12181e5f       604f5db92eaa8       32 seconds ago      Exited              kube-apiserver            4                   70a50831f4f59       kube-apiserver-controlplane
798045beec025       1766f54c897f0       3 minutes ago       Running             kube-scheduler            2                   d52c93f096079       kube-scheduler-controlplane
e5beed8cd4a6d       045733566833c       3 minutes ago       Running             kube-controller-manager   2                   3f45e3732d325       kube-controller-manager-controlplane
062bdfb10b6de       2e96e5913fc06       6 minutes ago       Running             etcd                      0                   da86c9d438c1d       etcd-controlplane
eee5fd513ad3c       1766f54c897f0       11 minutes ago      Exited              kube-scheduler            1                   d52c93f096079       kube-scheduler-controlplane
6f27a19a1d7dc       045733566833c       11 minutes ago      Exited              kube-controller-manager   1                   3f45e3732d325       kube-controller-manager-controlplane
1c127560ff0d2       ead0a4a53df89       44 minutes ago      Running             coredns                   0                   dcb1f099bbd76       coredns-77d6fd4654-gjc9c
09ba1480ea727       ead0a4a53df89       44 minutes ago      Running             coredns                   0                   ec83d0a5b8e31       coredns-77d6fd4654-7h78m
56595a7708416       01cdfa8dd262f       45 minutes ago      Running             kube-flannel              0                   c7cb23c7bb66d       kube-flannel-ds-962zc
343daf7f56e09       01cdfa8dd262f       45 minutes ago      Exited              install-cni               0                   c7cb23c7bb66d       kube-flannel-ds-962zc
612eb694b0b0f       a55d1bad692b7       45 minutes ago      Exited              install-cni-plugin        0                   c7cb23c7bb66d       kube-flannel-ds-962zc
cb51d2a0ff7d9       ad83b2ca7b09e       45 minutes ago      Running             kube-proxy                0                   3b6a86cffd4b9       kube-proxy-qmvrq

controlplane ~ ➜  crictl ps -a | grep kube-apiserver
c49dc12181e5f       604f5db92eaa8       49 seconds ago      Exited              kube-apiserver            4                   70a50831f4f59       kube-apiserver-controlplane

controlplane ~ ➜  crictl logs c49dc12181e5f
I1018 13:22:25.158886       1 options.go:228] external host was not specified, using 192.22.143.6
I1018 13:22:25.160885       1 server.go:142] Version: v1.31.0
I1018 13:22:25.160909       1 server.go:144] "Golang settings" GOGC="" GOMAXPROCS="" GOTRACEBACK=""
I1018 13:22:25.467185       1 shared_informer.go:313] Waiting for caches to sync for node_authorizer
W1018 13:22:25.471511       1 logging.go:55] [core] [Channel #2 SubChannel #3]grpc: addrConn.createTransport failed to connect to {Addr: "127.0.0.1:2379", ServerName: "127.0.0.1:2379", }. Err: connection error: desc = "transport: authentication handshake failed: tls: failed to verify certificate: x509: certificate signed by unknown authority"
W1018 13:22:25.473434       1 logging.go:55] [core] [Channel #1 SubChannel #4]grpc: addrConn.createTransport failed to connect to {Addr: "127.0.0.1:2379", ServerName: "127.0.0.1:2379", }. Err: connection error: desc = "transport: authentication handshake failed: tls: failed to verify certificate: x509: certificate signed by unknown authority"
I1018 13:22:25.477464       1 shared_informer.go:313] Waiting for caches to sync for *generic.policySource[*k8s.io/api/admissionregistration/v1.ValidatingAdmissionPolicy,*k8s.io/api/admissionregistration/v1.ValidatingAdmissionPolicyBinding,k8s.io/apiserver/pkg/admission/plugin/policy/validating.Validator]
I1018 13:22:25.480844       1 plugins.go:157] Loaded 12 mutating admission controller(s) successfully in the following order: NamespaceLifecycle,LimitRanger,ServiceAccount,NodeRestriction,TaintNodesByCondition,Priority,DefaultTolerationSeconds,DefaultStorageClass,StorageObjectInUseProtection,RuntimeClass,DefaultIngressClass,MutatingAdmissionWebhook.
I1018 13:22:25.480878       1 plugins.go:160] Loaded 13 validating admission controller(s) successfully in the following order: LimitRanger,ServiceAccount,PodSecurity,Priority,PersistentVolumeClaimResize,RuntimeClass,CertificateApproval,CertificateSigning,ClusterTrustBundleAttest,CertificateSubjectRestriction,ValidatingAdmissionPolicy,ValidatingAdmissionWebhook,ResourceQuota.
I1018 13:22:25.481087       1 instance.go:232] Using reconciler: lease
W1018 13:22:25.484152       1 logging.go:55] [core] [Channel #5 SubChannel #6]grpc: addrConn.createTransport failed to connect to {Addr: "127.0.0.1:2379", ServerName: "127.0.0.1:2379", }. Err: connection error: desc = "transport: authentication handshake failed: tls: failed to verify certificate: x509: certificate signed by unknown authority"
W1018 13:22:26.475061       1 logging.go:55] [core] [Channel #2 SubChannel #3]grpc: addrConn.createTransport failed to connect to {Addr: "127.0.0.1:2379", ServerName: "127.0.0.1:2379", }. Err: connection error: desc = "transport: authentication handshake failed: tls: failed to verify certificate: x509: certificate signed by unknown authority"
W1018 13:22:26.477099       1 logging.go:55] [core] [Channel #1 SubChannel #4]grpc: addrConn.createTransport failed to connect to {Addr: "127.0.0.1:2379", ServerName: "127.0.0.1:2379", }. Err: connection error: desc = "transport: authentication handshake failed: tls: failed to verify certificate: x509: certificate signed by unknown authority"
W1018 13:22:26.487181       1 logging.go:55] [core] [Channel #5 SubChannel #6]grpc: addrConn.createTransport failed to connect to {Addr: "127.0.0.1:2379", ServerName: "127.0.0.1:2379", }. Err: connection error: desc = "transport: authentication handshake failed: tls: failed to verify certificate: x509: certificate signed by unknown authority"
W1018 13:22:27.773982       1 logging.go:55] [core] [Channel #5 SubChannel #6]grpc: addrConn.createTransport failed to connect to {Addr: "127.0.0.1:2379", ServerName: "127.0.0.1:2379", }. Err: connection error: desc = "transport: authentication handshake failed: tls: failed to verify certificate: x509: certificate signed by unknown authority"
W1018 13:22:27.937467       1 logging.go:55] [core] [Channel #2 SubChannel #3]grpc: addrConn.createTransport failed to connect to {Addr: "127.0.0.1:2379", ServerName: "127.0.0.1:2379", }. Err: connection error: desc = "transport: authentication handshake failed: tls: failed to verify certificate: x509: certificate signed by unknown authority"
W1018 13:22:28.336307       1 logging.go:55] [core] [Channel #1 SubChannel #4]grpc: addrConn.createTransport failed to connect to {Addr: "127.0.0.1:2379", ServerName: "127.0.0.1:2379", }. Err: connection error: desc = "transport: authentication handshake failed: tls: failed to verify certificate: x509: certificate signed by unknown authority"
W1018 13:22:30.799430       1 logging.go:55] [core] [Channel #5 SubChannel #6]grpc: addrConn.createTransport failed to connect to {Addr: "127.0.0.1:2379", ServerName: "127.0.0.1:2379", }. Err: connection error: desc = "transport: authentication handshake failed: tls: failed to verify certificate: x509: certificate signed by unknown authority"
W1018 13:22:30.805022       1 logging.go:55] [core] [Channel #1 SubChannel #4]grpc: addrConn.createTransport failed to connect to {Addr: "127.0.0.1:2379", ServerName: "127.0.0.1:2379", }. Err: connection error: desc = "transport: authentication handshake failed: tls: failed to verify certificate: x509: certificate signed by unknown authority"
W1018 13:22:30.877056       1 logging.go:55] [core] [Channel #2 SubChannel #3]grpc: addrConn.createTransport failed to connect to {Addr: "127.0.0.1:2379", ServerName: "127.0.0.1:2379", }. Err: connection error: desc = "transport: authentication handshake failed: tls: failed to verify certificate: x509: certificate signed by unknown authority"
W1018 13:22:34.695662       1 logging.go:55] [core] [Channel #1 SubChannel #4]grpc: addrConn.createTransport failed to connect to {Addr: "127.0.0.1:2379", ServerName: "127.0.0.1:2379", }. Err: connection error: desc = "transport: authentication handshake failed: tls: failed to verify certificate: x509: certificate signed by unknown authority"
W1018 13:22:35.087479       1 logging.go:55] [core] [Channel #2 SubChannel #3]grpc: addrConn.createTransport failed to connect to {Addr: "127.0.0.1:2379", ServerName: "127.0.0.1:2379", }. Err: connection error: desc = "transport: authentication handshake failed: tls: failed to verify certificate: x509: certificate signed by unknown authority"
W1018 13:22:35.218149       1 logging.go:55] [core] [Channel #5 SubChannel #6]grpc: addrConn.createTransport failed to connect to {Addr: "127.0.0.1:2379", ServerName: "127.0.0.1:2379", }. Err: connection error: desc = "transport: authentication handshake failed: tls: failed to verify certificate: x509: certificate signed by unknown authority"
W1018 13:22:40.959831       1 logging.go:55] [core] [Channel #2 SubChannel #3]grpc: addrConn.createTransport failed to connect to {Addr: "127.0.0.1:2379", ServerName: "127.0.0.1:2379", }. Err: connection error: desc = "transport: authentication handshake failed: tls: failed to verify certificate: x509: certificate signed by unknown authority"
W1018 13:22:42.433082       1 logging.go:55] [core] [Channel #1 SubChannel #4]grpc: addrConn.createTransport failed to connect to {Addr: "127.0.0.1:2379", ServerName: "127.0.0.1:2379", }. Err: connection error: desc = "transport: authentication handshake failed: tls: failed to verify certificate: x509: certificate signed by unknown authority"
W1018 13:22:42.974183       1 logging.go:55] [core] [Channel #5 SubChannel #6]grpc: addrConn.createTransport failed to connect to {Addr: "127.0.0.1:2379", ServerName: "127.0.0.1:2379", }. Err: connection error: desc = "transport: authentication handshake failed: tls: failed to verify certificate: x509: certificate signed by unknown authority"
F1018 13:22:45.483691       1 instance.go:225] Error creating leases: error creating storage factory: context deadline exceeded

controlplane ~ ➜  crictl logs --tail=2 c49dc12181e5f
W1018 13:22:42.974183       1 logging.go:55] [core] [Channel #5 SubChannel #6]grpc: addrConn.createTransport failed to connect to {Addr: "127.0.0.1:2379", ServerName: "127.0.0.1:2379", }. Err: connection error: desc = "transport: authentication handshake failed: tls: failed to verify certificate: x509: certificate signed by unknown authority"
F1018 13:22:45.483691       1 instance.go:225] Error creating leases: error creating storage factory: context deadline exceeded

controlplane ~ ➜  cat /etc/kubernetes/pki/etcd/ca.crt 
-----BEGIN CERTIFICATE-----
MIIC/DCCAeSgAwIBAgIILLqyRcABauwwDQYJKoZIhvcNAQELBQAwEjEQMA4GA1UE
AxMHZXRjZC1jYTAeFw0yNDEwMTgxMjMyMzFaFw0zNDEwMTYxMjM3MzFaMBIxEDAO
BgNVBAMTB2V0Y2QtY2EwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDl
WqEuuSRGaEiQMCf6+dYobh0dNHxgruYu/D/sZE7qVE/FNlOC7gWS9afGEw+zzZXA
Oyl4OTZJHyVKqMZQgXVhxMCLI0/OLW9zI/cMSXP0iyAwY7txY2ub3/3WCUyeSGPe
59wy/sKea1jfMJ2hRSNApc76+IV7CI+Oo8/QLt12u9yTzs6+A+dbcKis0JnUWvEL
C7KBLiA8cQpTfDNbtsBDdsG7DgphY4jHp6Top3tCiZDDRUQYuib0jsomUwyVSAA+
CfmoX75gBNWsQ0Nw2CEgUElc9i6boNMXMxQTNZDuoyttUfj75Yl//PuDLwZAU5Il
rNaYuNLM0D+EQePC37QLAgMBAAGjVjBUMA4GA1UdDwEB/wQEAwICpDAPBgNVHRMB
Af8EBTADAQH/MB0GA1UdDgQWBBTxmUzIh2OHuQRH8WGj0ILAWWJ1AzASBgNVHREE
CzAJggdldGNkLWNhMA0GCSqGSIb3DQEBCwUAA4IBAQA4KguN2gPi6jIoMm6M2+Sj
oT5BWm0cM6PHZ+Di+aWTIbFYC6lUOH2Nn7J2J5msOj3XPSJeQJ5tcdon1plCCAQJ
aOPDUAKU1AsSMKK23ueDjvlWGyIjQpRARqrCNQg5v7riNasQzzizMoE24dEvNgTl
d8ROvGvnoKZETiRuXF0zAmobr3r3aQzlbw82f2sRPBqyuUOzSbzG2CoG1qj/hhjD
eNd74JjBgCNDdLr5yMJLXIau3cUO2ufNPdnnPALmMeyBwDuuq+9XbnJNEnZGa9BQ
0eymVF5HEFeDqAhC9WpMjxSVWQdYoR59tKIScbR1spQ6PoDlvgd5BvgiSJAcMIf5
-----END CERTIFICATE-----

controlplane ~ ➜  cat /etc/kubernetes/manifests/kube-apiserver.yaml 
apiVersion: v1
kind: Pod
metadata:
  annotations:
    kubeadm.kubernetes.io/kube-apiserver.advertise-address.endpoint: 192.22.143.6:6443
  creationTimestamp: null
  labels:
    component: kube-apiserver
    tier: control-plane
  name: kube-apiserver
  namespace: kube-system
spec:
  containers:
  - command:
    - kube-apiserver
    - --advertise-address=192.22.143.6
    - --allow-privileged=true
    - --authorization-mode=Node,RBAC
    - --client-ca-file=/etc/kubernetes/pki/ca.crt
    - --enable-admission-plugins=NodeRestriction
    - --enable-bootstrap-token-auth=true
    - --etcd-cafile=/etc/kubernetes/pki/ca.crt
    - --etcd-certfile=/etc/kubernetes/pki/apiserver-etcd-client.crt
    - --etcd-keyfile=/etc/kubernetes/pki/apiserver-etcd-client.key
    - --etcd-servers=https://127.0.0.1:2379
    - --kubelet-client-certificate=/etc/kubernetes/pki/apiserver-kubelet-client.crt
    - --kubelet-client-key=/etc/kubernetes/pki/apiserver-kubelet-client.key
    - --kubelet-preferred-address-types=InternalIP,ExternalIP,Hostname
    - --proxy-client-cert-file=/etc/kubernetes/pki/front-proxy-client.crt
    - --proxy-client-key-file=/etc/kubernetes/pki/front-proxy-client.key
    - --requestheader-allowed-names=front-proxy-client
    - --requestheader-client-ca-file=/etc/kubernetes/pki/front-proxy-ca.crt
    - --requestheader-extra-headers-prefix=X-Remote-Extra-
    - --requestheader-group-headers=X-Remote-Group
    - --requestheader-username-headers=X-Remote-User
    - --secure-port=6443
    - --service-account-issuer=https://kubernetes.default.svc.cluster.local
    - --service-account-key-file=/etc/kubernetes/pki/sa.pub
    - --service-account-signing-key-file=/etc/kubernetes/pki/sa.key
    - --service-cluster-ip-range=10.96.0.0/12
    - --tls-cert-file=/etc/kubernetes/pki/apiserver.crt
    - --tls-private-key-file=/etc/kubernetes/pki/apiserver.key
    image: registry.k8s.io/kube-apiserver:v1.31.0
    imagePullPolicy: IfNotPresent
    livenessProbe:
      failureThreshold: 8
      httpGet:
        host: 192.22.143.6
        path: /livez
        port: 6443
        scheme: HTTPS
      initialDelaySeconds: 10
      periodSeconds: 10
      timeoutSeconds: 15
    name: kube-apiserver
    readinessProbe:
      failureThreshold: 3
      httpGet:
        host: 192.22.143.6
        path: /readyz
        port: 6443
        scheme: HTTPS
      periodSeconds: 1
      timeoutSeconds: 15
    resources:
      requests:
        cpu: 250m
    startupProbe:
      failureThreshold: 24
      httpGet:
        host: 192.22.143.6
        path: /livez
        port: 6443
        scheme: HTTPS
      initialDelaySeconds: 10
      periodSeconds: 10
      timeoutSeconds: 15
    volumeMounts:
    - mountPath: /etc/ssl/certs
      name: ca-certs
      readOnly: true
    - mountPath: /etc/ca-certificates
      name: etc-ca-certificates
      readOnly: true
    - mountPath: /etc/kubernetes/pki
      name: k8s-certs
      readOnly: true
    - mountPath: /usr/local/share/ca-certificates
      name: usr-local-share-ca-certificates
      readOnly: true
    - mountPath: /usr/share/ca-certificates
      name: usr-share-ca-certificates
      readOnly: true
  hostNetwork: true
  priority: 2000001000
  priorityClassName: system-node-critical
  securityContext:
    seccompProfile:
      type: RuntimeDefault
  volumes:
  - hostPath:
      path: /etc/ssl/certs
      type: DirectoryOrCreate
    name: ca-certs
  - hostPath:
      path: /etc/ca-certificates
      type: DirectoryOrCreate
    name: etc-ca-certificates
  - hostPath:
      path: /etc/kubernetes/pki
      type: DirectoryOrCreate
    name: k8s-certs
  - hostPath:
      path: /usr/local/share/ca-certificates
      type: DirectoryOrCreate
    name: usr-local-share-ca-certificates
  - hostPath:
      path: /usr/share/ca-certificates
      type: DirectoryOrCreate
    name: usr-share-ca-certificates
status: {}

controlplane ~ ➜  vi /etc/kubernetes/manifests/kube-apiserver.yaml 

controlplane ~ ➜  cat /etc/kubernetes/manifests/kube-apiserver.yaml 
apiVersion: v1
kind: Pod
metadata:
  annotations:
    kubeadm.kubernetes.io/kube-apiserver.advertise-address.endpoint: 192.22.143.6:6443
  creationTimestamp: null
  labels:
    component: kube-apiserver
    tier: control-plane
  name: kube-apiserver
  namespace: kube-system
spec:
  containers:
  - command:
    - kube-apiserver
    - --advertise-address=192.22.143.6
    - --allow-privileged=true
    - --authorization-mode=Node,RBAC
    - --client-ca-file=/etc/kubernetes/pki/ca.crt
    - --enable-admission-plugins=NodeRestriction
    - --enable-bootstrap-token-auth=true
    - --etcd-cafile=/etc/kubernetes/pki/etcd/ca.crt
    - --etcd-certfile=/etc/kubernetes/pki/apiserver-etcd-client.crt
    - --etcd-keyfile=/etc/kubernetes/pki/apiserver-etcd-client.key
    - --etcd-servers=https://127.0.0.1:2379
    - --kubelet-client-certificate=/etc/kubernetes/pki/apiserver-kubelet-client.crt
    - --kubelet-client-key=/etc/kubernetes/pki/apiserver-kubelet-client.key
    - --kubelet-preferred-address-types=InternalIP,ExternalIP,Hostname
    - --proxy-client-cert-file=/etc/kubernetes/pki/front-proxy-client.crt
    - --proxy-client-key-file=/etc/kubernetes/pki/front-proxy-client.key
    - --requestheader-allowed-names=front-proxy-client
    - --requestheader-client-ca-file=/etc/kubernetes/pki/front-proxy-ca.crt
    - --requestheader-extra-headers-prefix=X-Remote-Extra-
    - --requestheader-group-headers=X-Remote-Group
    - --requestheader-username-headers=X-Remote-User
    - --secure-port=6443
    - --service-account-issuer=https://kubernetes.default.svc.cluster.local
    - --service-account-key-file=/etc/kubernetes/pki/sa.pub
    - --service-account-signing-key-file=/etc/kubernetes/pki/sa.key
    - --service-cluster-ip-range=10.96.0.0/12
    - --tls-cert-file=/etc/kubernetes/pki/apiserver.crt
    - --tls-private-key-file=/etc/kubernetes/pki/apiserver.key
    image: registry.k8s.io/kube-apiserver:v1.31.0
    imagePullPolicy: IfNotPresent
    livenessProbe:
      failureThreshold: 8
      httpGet:
        host: 192.22.143.6
        path: /livez
        port: 6443
        scheme: HTTPS
      initialDelaySeconds: 10
      periodSeconds: 10
      timeoutSeconds: 15
    name: kube-apiserver
    readinessProbe:
      failureThreshold: 3
      httpGet:
        host: 192.22.143.6
        path: /readyz
        port: 6443
        scheme: HTTPS
      periodSeconds: 1
      timeoutSeconds: 15
    resources:
      requests:
        cpu: 250m
    startupProbe:
      failureThreshold: 24
      httpGet:
        host: 192.22.143.6
        path: /livez
        port: 6443
        scheme: HTTPS
      initialDelaySeconds: 10
      periodSeconds: 10
      timeoutSeconds: 15
    volumeMounts:
    - mountPath: /etc/ssl/certs
      name: ca-certs
      readOnly: true
    - mountPath: /etc/ca-certificates
      name: etc-ca-certificates
      readOnly: true
    - mountPath: /etc/kubernetes/pki
      name: k8s-certs
      readOnly: true
    - mountPath: /usr/local/share/ca-certificates
      name: usr-local-share-ca-certificates
      readOnly: true
    - mountPath: /usr/share/ca-certificates
      name: usr-share-ca-certificates
      readOnly: true
  hostNetwork: true
  priority: 2000001000
  priorityClassName: system-node-critical
  securityContext:
    seccompProfile:
      type: RuntimeDefault
  volumes:
  - hostPath:
      path: /etc/ssl/certs
      type: DirectoryOrCreate
    name: ca-certs
  - hostPath:
      path: /etc/ca-certificates
      type: DirectoryOrCreate
    name: etc-ca-certificates
  - hostPath:
      path: /etc/kubernetes/pki
      type: DirectoryOrCreate
    name: k8s-certs
  - hostPath:
      path: /usr/local/share/ca-certificates
      type: DirectoryOrCreate
    name: usr-local-share-ca-certificates
  - hostPath:
      path: /usr/share/ca-certificates
      type: DirectoryOrCreate
    name: usr-share-ca-certificates
status: {}

controlplane ~ ➜  k get pod -n kube-system 
NAME                                   READY   STATUS    RESTARTS      AGE
coredns-77d6fd4654-7h78m               1/1     Running   0             51m
coredns-77d6fd4654-gjc9c               1/1     Running   0             51m
etcd-controlplane                      1/1     Running   0             51m
kube-apiserver-controlplane            1/1     Running   0             51m
kube-controller-manager-controlplane   1/1     Running   2 (10m ago)   51m
kube-proxy-qmvrq                       1/1     Running   0             51m
kube-scheduler-controlplane            1/1     Running   2 (10m ago)   51m

controlplane ~ ➜  

```


